<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add New Beneficiary | Project UDAAN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #1e3a8a;
            --secondary-blue: #3b82f6;
            --primary-orange: #f97316;
            --secondary-orange: #fb923c;
            --accent-yellow: #fbbf24;
            --light-gray: #f8fafc;
            --dark-gray: #1f2937;
            --success-green: #10b981;
            --sidebar-bg: #f9fafb;
            --card-bg: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--light-gray) 0%, #ffffff 100%);
            color: var(--dark-gray);
            min-height: 100vh;
        }

        /* Top Blue Bar */
        .top-bar {
            background: var(--primary-blue);
            height: 4px;
            width: 100%;
        }

        /* Sidebar */
        .sidebar {
            background: var(--sidebar-bg);
            width: 280px;
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            padding: 20px 0;
            border-right: 1px solid #e5e7eb;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        }

        .sidebar-header {
            padding: 0 20px 20px 20px;
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 20px;
        }

        .sidebar-brand {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-brand img {
            width: 40px;
            height: 40px;
            border-radius: 8px;
        }

        .sidebar-brand h2 {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin: 0;
        }

        .nav-menu {
            list-style: none;
            padding: 0;
        }

        .nav-item {
            margin-bottom: 5px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: var(--dark-gray);
            text-decoration: none;
            transition: all 0.3s ease;
            border-radius: 8px;
            margin: 0 10px;
        }

        .nav-link:hover {
            background: rgba(59, 130, 246, 0.1);
            color: var(--primary-blue);
            transform: translateX(5px);
        }

        .nav-link.active {
            background: var(--accent-yellow);
            color: var(--dark-gray);
            font-weight: 600;
        }

        .nav-link i {
            width: 20px;
            text-align: center;
        }

        .logout-item {
            margin-top: auto;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            padding-top: 20px;
        }

        .logout-link {
            color: #ef4444 !important;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .logout-link:hover {
            background: rgba(239, 68, 68, 0.2) !important;
            color: #dc2626 !important;
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            padding: 30px;
            min-height: 100vh;
        }

        .page-header {
            margin-bottom: 30px;
            text-align: center;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary-blue);
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--primary-blue), var(--primary-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-subtitle {
            color: #6b7280;
            font-size: 1.1rem;
        }

        /* Form Container */
        .form-container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
        }

        .form-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(45deg, var(--primary-blue), var(--primary-orange), var(--accent-yellow));
        }

        /* Form Styling */
        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            font-weight: 600;
            color: var(--dark-gray);
            margin-bottom: 8px;
            display: block;
            font-size: 0.95rem;
        }

        .form-control, .form-select {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        .form-control:focus, .form-select:focus {
            outline: none;
            border-color: var(--secondary-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            background: white;
            transform: translateY(-2px);
        }

        .error-message {
            color: #dc3545;
            font-size: 0.875rem;
            margin-top: 5px;
            display: none;
        }

        .form-control.error,
        .form-select.error {
            border-color: #dc3545;
        }

        .form-control.error:focus,
        .form-select.error:focus {
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.1);
        }

        .form-control::placeholder {
            color: #9ca3af;
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        /* Row for side-by-side fields */
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* File Upload Styling */
        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-upload input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-upload-label {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px 20px;
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            background: #f9fafb;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #6b7280;
        }

        .file-upload-label:hover {
            border-color: var(--secondary-blue);
            background: #f0f9ff;
            color: var(--secondary-blue);
        }

        .file-upload-label i {
            font-size: 1.2rem;
        }

        /* Submit Button */
        .btn-submit {
            background: linear-gradient(45deg, var(--accent-yellow), #f59e0b);
            color: var(--dark-gray);
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(251, 191, 36, 0.3);
            position: relative;
            overflow: hidden;
            float: right;
        }

        .btn-submit::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .btn-submit:hover::before {
            left: 100%;
        }

        .btn-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(251, 191, 36, 0.4);
        }

        /* Checkbox Group Styling */
        .checkbox-group {
            background: #f8fafc;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px 0;
        }

        .checkbox-item:last-child {
            margin-bottom: 0;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 12px;
            accent-color: var(--primary-blue);
            cursor: pointer;
        }

        .checkbox-item label {
            font-size: 1rem;
            color: var(--dark-gray);
            cursor: pointer;
            flex: 1;
            margin: 0;
        }

        .checkbox-item:hover {
            background: #f0f9ff;
            border-radius: 8px;
            padding: 8px 12px;
            margin: 0 -12px 12px -12px;
        }

        /* Experience Section Styling */
        .experience-entry {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .experience-entry:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-color: var(--secondary-blue);
        }

        .experience-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }

        .form-label-small {
            font-weight: 500;
            color: var(--dark-gray);
            margin-bottom: 6px;
            display: block;
            font-size: 0.9rem;
        }

        .btn-add-experience {
            background: linear-gradient(45deg, var(--primary-blue), var(--secondary-blue));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-add-experience:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
        }

        .btn-add-experience:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Responsive Design for Experience Section */
        @media (max-width: 768px) {
            .experience-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .experience-entry {
                padding: 15px;
            }
            
            .btn-add-experience {
                width: 100%;
                justify-content: center;
            }
        }

        /* Success Message */
        .success-message {
            background: var(--success-green);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: none;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                border-right: none;
                border-bottom: 1px solid #e5e7eb;
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }

            .form-container {
                padding: 30px 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .page-title {
                font-size: 2rem;
            }
        }

        /* Animation */
        .form-group {
            animation: fadeInUp 0.6s ease-out;
        }

        .form-group:nth-child(1) { animation-delay: 0.1s; }
        .form-group:nth-child(2) { animation-delay: 0.2s; }
        .form-group:nth-child(3) { animation-delay: 0.3s; }
        .form-group:nth-child(4) { animation-delay: 0.4s; }
        .form-group:nth-child(5) { animation-delay: 0.5s; }
        .form-group:nth-child(6) { animation-delay: 0.6s; }
        .form-group:nth-child(7) { animation-delay: 0.7s; }
        .form-group:nth-child(8) { animation-delay: 0.8s; }
        .form-group:nth-child(9) { animation-delay: 0.9s; }
        .form-group:nth-child(10) { animation-delay: 1.0s; }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- Top Blue Bar -->
    <div class="top-bar"></div>

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-brand">
                <img src="A5036245-949C-43AA-A1F7-542427665F31.png" alt="Project UDAAN Logo">
                <h2>Project UDAAN</h2>
            </div>
        </div>

        <ul class="nav-menu">
            <li class="nav-item">
                <a href="dashboard.html" class="nav-link">
                    <i class="fas fa-home"></i>
                    Dashboard
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <i class="fas fa-users"></i>
                    Beneficiaries
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link active">
                    <i class="fas fa-plus-circle"></i>
                    Add New Beneficiary
                </a>
            </li>
            <li class="nav-item logout-item">
                <a href="index.html" class="nav-link logout-link">
                    <i class="fas fa-sign-out-alt"></i>
                    Logout
                </a>
            </li>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="page-header">
            <h1 class="page-title">Add New Beneficiary</h1>
            <p class="page-subtitle">Register a new beneficiary to the Project UDAAN program</p>
        </div>

        <!-- Success Message -->
        <div class="success-message" id="successMessage">
            <i class="fas fa-check-circle"></i> Beneficiary added successfully!
        </div>

        <!-- Form Container -->
        <div class="form-container">
            <form id="beneficiaryForm">
                <!-- Name -->
                <div class="form-group">
                    <label for="name" class="form-label">
                        <i class="fas fa-user"></i> Full Name *
                    </label>
                    <input type="text" id="name" name="name" class="form-control" placeholder="Enter full name" required>
                    <div class="error-message" id="name-error"></div>
                </div>

                <!-- Age and Gender Row -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="age" class="form-label">
                            <i class="fas fa-birthday-cake"></i> Age * (18 or above)
                        </label>
                        <input type="number" id="age" name="age" class="form-control" placeholder="Enter age" min="18" max="120" required>
                        <div class="error-message" id="age-error"></div>
                    </div>
                    <div class="form-group">
                        <label for="gender" class="form-label">
                            <i class="fas fa-venus-mars"></i> Gender *
                        </label>
                        <select id="gender" name="gender" class="form-select" required>
                            <option value="">Select gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                        <div class="error-message" id="gender-error"></div>
                    </div>
                </div>

                <!-- Contact Number -->
                <div class="form-group">
                    <label for="contact" class="form-label">
                        <i class="fas fa-phone"></i> Contact Number * (exactly 10 digits)
                    </label>
                    <input type="tel" id="contact" name="contact" class="form-control" placeholder="Enter 10-digit contact number" pattern="[0-9]{10}" maxlength="10" required>
                    <div class="error-message" id="contact-error"></div>
                </div>

                <!-- Address Section -->
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-map-marker-alt"></i> Address *
                    </label>
                    
                    <!-- Postal Code and City Row -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="postalCode" class="form-label">Postal Code * (6 digits)</label>
                            <input type="text" id="postalCode" name="postalCode" class="form-control" placeholder="Enter 6-digit postal code" pattern="[0-9]{6}" maxlength="6" required>
                            <div class="error-message" id="postalCode-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="city" class="form-label">City *</label>
                            <input type="text" id="city" name="city" class="form-control" placeholder="Enter city" required>
                            <div class="error-message" id="city-error"></div>
                        </div>
                    </div>
                    
                    <!-- State -->
                    <div class="form-group">
                        <label for="state" class="form-label">State *</label>
                        <input type="text" id="state" name="state" class="form-control" placeholder="Enter state" required>
                        <div class="error-message" id="state-error"></div>
                    </div>
                    
                    <!-- Full Address -->
                    <div class="form-group">
                        <label for="address" class="form-label">Full Address *</label>
                        <textarea id="address" name="address" class="form-control" placeholder="Enter complete address" rows="3" required></textarea>
                        <div class="error-message" id="address-error"></div>
                    </div>
                </div>

                <!-- Type of Support -->
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-wheelchair"></i> Type of Support *
                    </label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="support1" name="supportNeeded" value="below-knee-prosthesis" onchange="toggleFunctionalityOptions()">
                            <label for="support1">Below-knee prosthesis (leg)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="support2" name="supportNeeded" value="above-knee-prosthesis" onchange="toggleFunctionalityOptions()">
                            <label for="support2">Above-knee prosthesis (leg)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="support3" name="supportNeeded" value="artificial-hand-arm">
                            <label for="support3">Artificial hand or arm (limited functionality)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="support4" name="supportNeeded" value="calipers-mobility">
                            <label for="support4">Calipers or mobility support (e.g., for polio-affected limb)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="support5" name="supportNeeded" value="other-physical">
                            <label for="support5">Other physical support</label>
                        </div>
                    </div>
                    <div class="error-message" id="supportNeeded-error"></div>
                </div>

                <!-- Functionality Options (shown only for prosthesis users) -->
                <div class="form-group" id="functionalityOptions" style="display: none;">
                    <label class="form-label">
                        <i class="fas fa-tasks"></i> What can you do with your prosthesis? *
                    </label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="func1" name="functionality" value="walk">
                            <label for="func1">Walk</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="func2" name="functionality" value="sit">
                            <label for="func2">Sit</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="func3" name="functionality" value="squat">
                            <label for="func3">Squat</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="func4" name="functionality" value="swim">
                            <label for="func4">Swim</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="func5" name="functionality" value="dance">
                            <label for="func5">Dance</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="func6" name="functionality" value="climb">
                            <label for="func6">Climb a tree/mountain</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="func7" name="functionality" value="bicycle">
                            <label for="func7">Ride a bi-cycle</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="func8" name="functionality" value="drive">
                            <label for="func8">Drive a car</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="func9" name="functionality" value="other" onchange="toggleOtherFunctionality()">
                            <label for="func9">Other</label>
                        </div>
                    </div>
                    <div class="error-message" id="functionality-error"></div>
                </div>

                <!-- Other Functionality Input (shown when "Other" is selected) -->
                <div class="form-group" id="otherFunctionalityInput" style="display: none;">
                    <label for="otherFunctionality" class="form-label">
                        <i class="fas fa-edit"></i> Please specify other functionality
                    </label>
                    <input type="text" id="otherFunctionality" name="otherFunctionality" class="form-control" placeholder="Describe what other activities you can do with your prosthesis..." oninput="updateFunctionalAbility()">
                    <div class="error-message" id="otherFunctionality-error"></div>
                </div>

                <!-- Side of the Body Affected -->
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-user"></i> Side of the Body Affected *
                    </label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="side1" name="bodySide" value="right-leg">
                            <label for="side1">Right Leg</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="side2" name="bodySide" value="left-leg">
                            <label for="side2">Left Leg</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="side3" name="bodySide" value="right-arm">
                            <label for="side3">Right Arm/Hand</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="side4" name="bodySide" value="left-arm">
                            <label for="side4">Left Arm/Hand</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="side5" name="bodySide" value="both-legs">
                            <label for="side5">Both legs</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="side6" name="bodySide" value="both-arms">
                            <label for="side6">Both arms</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="side7" name="bodySide" value="other">
                            <label for="side7">Other / Not sure</label>
                        </div>
                    </div>
                    <div class="error-message" id="bodySide-error"></div>
                </div>

                <!-- Functional Ability -->
                <div class="form-group">
                    <label for="functionalAbility" class="form-label">
                        <i class="fas fa-tasks"></i> Functional Ability *
                    </label>
                    <textarea id="functionalAbility" name="functionalAbility" class="form-control" placeholder="What functions are you currently able to perform, or what would you like to be able to do after prosthesis or caliper installation? (e.g., walk short distances, climb stairs, hold objects, lift light items, drive a vehicle, sew clothes, etc.)" rows="4" required></textarea>
                    <div class="error-message" id="functionalAbility-error"></div>
                </div>

                <!-- Education -->
                <div class="form-group">
                    <label for="education" class="form-label">
                        <i class="fas fa-graduation-cap"></i> Education
                    </label>
                    <select id="education" name="education" class="form-select" required>
                        <option value="">Select education level</option>
                        <option value="none">No Formal Education</option>
                        <option value="primary">Primary School</option>
                        <option value="secondary">Secondary School</option>
                        <option value="higher-secondary">Higher Secondary</option>
                        <option value="diploma">Diploma</option>
                        <option value="bachelor">Bachelor's Degree</option>
                        <option value="master">Master's Degree</option>
                        <option value="phd">PhD</option>
                    </select>
                </div>

                <!-- Skills -->
                <div class="form-group">
                    <label for="skills" class="form-label">
                        <i class="fas fa-tools"></i> Skills
                    </label>
                    <input type="text" id="skills" name="skills" class="form-control" placeholder="Enter skills (e.g., Computer skills, Communication, etc.)" required>
                </div>

                <!-- Past Job Experience -->
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-briefcase"></i> Past Job Experience
                    </label>
                    
                    <!-- Experience Entry 1 -->
                    <div class="experience-entry" id="experience1">
                        <div class="experience-row">
                            <div class="form-group">
                                <label for="company1" class="form-label-small">Company Name</label>
                                <input type="text" id="company1" name="company1" class="form-control" placeholder="Enter company name">
                            </div>
                            <div class="form-group">
                                <label for="position1" class="form-label-small">Position</label>
                                <input type="text" id="position1" name="position1" class="form-control" placeholder="Enter job position">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="description1" class="form-label-small">Job Description</label>
                            <textarea id="description1" name="description1" class="form-control" placeholder="Describe your role and responsibilities"></textarea>
                        </div>
                    </div>

                    <!-- Experience Entry 2 -->
                    <div class="experience-entry" id="experience2" style="display: none;">
                        <div class="experience-row">
                            <div class="form-group">
                                <label for="company2" class="form-label-small">Company Name</label>
                                <input type="text" id="company2" name="company2" class="form-control" placeholder="Enter company name">
                            </div>
                            <div class="form-group">
                                <label for="position2" class="form-label-small">Position</label>
                                <input type="text" id="position2" name="position2" class="form-control" placeholder="Enter job position">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="description2" class="form-label-small">Job Description</label>
                            <textarea id="description2" name="description2" class="form-control" placeholder="Describe your role and responsibilities"></textarea>
                        </div>
                    </div>

                    <!-- Experience Entry 3 -->
                    <div class="experience-entry" id="experience3" style="display: none;">
                        <div class="experience-row">
                            <div class="form-group">
                                <label for="company3" class="form-label-small">Company Name</label>
                                <input type="text" id="company3" name="company3" class="form-control" placeholder="Enter company name">
                            </div>
                            <div class="form-group">
                                <label for="position3" class="form-label-small">Position</label>
                                <input type="text" id="position3" name="position3" class="form-control" placeholder="Enter job position">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="description3" class="form-label-small">Job Description</label>
                            <textarea id="description3" name="description3" class="form-control" placeholder="Describe your role and responsibilities"></textarea>
                        </div>
                    </div>

                    <!-- Add More Experience Button -->
                    <div class="form-group" style="margin-top: 15px;">
                        <button type="button" class="btn-add-experience" onclick="addExperienceEntry()">
                            <i class="fas fa-plus"></i> Add Another Experience
                        </button>
                    </div>
                </div>

                <!-- Employment Status -->
                <div class="form-group">
                    <label for="employment" class="form-label">
                        <i class="fas fa-user-tie"></i> Employment Status *
                    </label>
                    <select id="employment" name="status" class="form-select" required>
                        <option value="">Select employment status</option>
                        <option value="unemployed">Unemployed</option>
                        <option value="self-employed">Self-employed</option>
                    </select>
                    <div class="error-message" id="employment-error"></div>
                </div>



                <!-- Submit Button -->
                <div class="form-group" style="margin-top: 40px;">
                    <button type="submit" class="btn-submit">
                        <i class="fas fa-plus"></i> Add Beneficiary
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDx_CzMcoaLHnhhTieyv-BC7nwD6UqBfnQ",
            authDomain: "project-udaan-d94d8.firebaseapp.com",
            projectId: "project-udaan-d94d8",
            storageBucket: "project-udaan-d94d8.firebasestorage.app",
            messagingSenderId: "355864298858",
            appId: "1:355864298858:web:a12200f903c098e578d113",
            measurementId: "G-QYSR3M4Y3T"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const analytics = getAnalytics(app);

        // Make Firebase available globally
        window.db = db;
        window.collection = collection;
        window.addDoc = addDoc;
        window.getDocs = getDocs;
        window.doc = doc;
        window.updateDoc = updateDoc;
        window.deleteDoc = deleteDoc;
        window.onSnapshot = onSnapshot;
    </script>
    
    <script>
        // Function to toggle functionality options based on prosthesis selection
        function toggleFunctionalityOptions() {
            const support1 = document.getElementById('support1').checked;
            const support2 = document.getElementById('support2').checked;
            const functionalityOptions = document.getElementById('functionalityOptions');
            const otherFunctionalityInput = document.getElementById('otherFunctionalityInput');
            const functionalAbilityField = document.getElementById('functionalAbility');
            
            // Show functionality options if any prosthesis is selected
            if (support1 || support2) {
                functionalityOptions.style.display = 'block';
                // Reset other functionality input when showing options
                otherFunctionalityInput.style.display = 'none';
                document.getElementById('otherFunctionality').value = '';
                
                // Add event listeners to functionality checkboxes to auto-populate Functional Ability
                document.querySelectorAll('input[name="functionality"]').forEach(checkbox => {
                    checkbox.addEventListener('change', updateFunctionalAbility);
                });
            } else {
                functionalityOptions.style.display = 'none';
                otherFunctionalityInput.style.display = 'none';
                // Uncheck all functionality options
                document.querySelectorAll('input[name="functionality"]').forEach(cb => cb.checked = false);
                document.getElementById('otherFunctionality').value = '';
                
                // Clear Functional Ability field and make it required again
                functionalAbilityField.value = '';
                functionalAbilityField.required = true;
                functionalAbilityField.placeholder = "What functions are you currently able to perform, or what would you like to be able to do after prosthesis or caliper installation? (e.g., walk short distances, climb stairs, hold objects, lift light items, drive a vehicle, sew clothes, etc.)";
            }
        }

        // Function to update Functional Ability field based on selected functionality options
        function updateFunctionalAbility() {
            const selectedFunctionality = Array.from(document.querySelectorAll('input[name="functionality"]:checked')).map(cb => cb.value);
            const otherFunctionality = document.getElementById('otherFunctionality').value;
            const functionalAbilityField = document.getElementById('functionalAbility');
            
            if (selectedFunctionality.length > 0) {
                let functionalityText = 'I can perform the following activities with my prosthesis:\n';
                selectedFunctionality.forEach(func => {
                    switch(func) {
                        case 'walk': functionalityText += '• Walk\n'; break;
                        case 'sit': functionalityText += '• Sit\n'; break;
                        case 'squat': functionalityText += '• Squat\n'; break;
                        case 'swim': functionalityText += '• Swim\n'; break;
                        case 'dance': functionalityText += '• Dance\n'; break;
                        case 'climb': functionalityText += '• Climb trees/mountains\n'; break;
                        case 'bicycle': functionalityText += '• Ride a bicycle\n'; break;
                        case 'drive': functionalityText += '• Drive a car\n'; break;
                        case 'other': functionalityText += `• ${otherFunctionality || 'Other activities'}\n`; break;
                    }
                });
                
                functionalAbilityField.value = functionalityText;
                functionalAbilityField.required = false; // Make it optional since it's auto-populated
                functionalAbilityField.placeholder = "This field is auto-populated based on your prosthesis functionality selections. You can edit it if needed.";
            } else {
                functionalAbilityField.value = '';
                functionalAbilityField.required = true;
                functionalAbilityField.placeholder = "What functions are you currently able to perform, or what would you like to be able to do after prosthesis or caliper installation? (e.g., walk short distances, climb stairs, hold objects, lift light items, drive a vehicle, sew clothes, etc.)";
            }
        }

        // Function to toggle other functionality input
        function toggleOtherFunctionality() {
            const otherCheckbox = document.getElementById('func9');
            const otherInput = document.getElementById('otherFunctionalityInput');
            
            if (otherCheckbox.checked) {
                otherInput.style.display = 'block';
            } else {
                otherInput.style.display = 'none';
                document.getElementById('otherFunctionality').value = '';
            }
            
            // Update Functional Ability field when other functionality changes
            updateFunctionalAbility();
        }

        // Function to add more experience entries
        function addExperienceEntry() {
            const experience2 = document.getElementById('experience2');
            const experience3 = document.getElementById('experience3');
            const addButton = document.querySelector('.btn-add-experience');
            
            if (experience2.style.display === 'none') {
                experience2.style.display = 'block';
                addButton.innerHTML = '<i class="fas fa-plus"></i> Add Another Experience';
            } else if (experience3.style.display === 'none') {
                experience3.style.display = 'block';
                addButton.innerHTML = '<i class="fas fa-check"></i> Maximum Experience Added';
                addButton.disabled = true;
            }
        }

        // Form validation and submission
        document.getElementById('beneficiaryForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            console.log('Form submitted!');
            
            // Clear previous errors
            clearErrors();
            
            // Validate form
            if (!validateForm()) {
                return;
            }
            
            const successMessage = document.getElementById('successMessage');
            const submitBtn = document.querySelector('.btn-submit');
            
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Adding...';
            submitBtn.disabled = true;
            
            // Get form data
            const formData = new FormData(this);
            console.log('FormData created:', formData);
            
            // Collect checkbox values
            const supportNeeded = Array.from(document.querySelectorAll('input[name="supportNeeded"]:checked')).map(cb => cb.value);
            const bodySide = Array.from(document.querySelectorAll('input[name="bodySide"]:checked')).map(cb => cb.value);
            const functionality = Array.from(document.querySelectorAll('input[name="functionality"]:checked')).map(cb => cb.value);
            const otherFunctionality = document.getElementById('otherFunctionality').value;
            
            // Collect experience data
            const experienceData = [];
            
            // Experience 1
            const company1 = document.getElementById('company1').value;
            const position1 = document.getElementById('position1').value;
            const description1 = document.getElementById('description1').value;
            if (company1 || position1 || description1) {
                experienceData.push({
                    company: company1,
                    position: position1,
                    description: description1
                });
            }
            
            // Experience 2
            const company2 = document.getElementById('company2').value;
            const position2 = document.getElementById('position2').value;
            const description2 = document.getElementById('description2').value;
            if (company2 || position2 || description2) {
                experienceData.push({
                    company: company2,
                    position: position2,
                    description: description2
                });
            }
            
            // Experience 3
            const company3 = document.getElementById('company3').value;
            const position3 = document.getElementById('position3').value;
            const description3 = document.getElementById('description3').value;
            if (company3 || position3 || description3) {
                experienceData.push({
                    company: company3,
                    position: position3,
                    description: description3
                });
            }
            
            // Log each field value
            console.log('Name:', formData.get('name'));
            console.log('Age:', formData.get('age'));
            console.log('Gender:', formData.get('gender'));
            console.log('Contact:', formData.get('contact'));
            console.log('Postal Code:', formData.get('postalCode'));
            console.log('City:', formData.get('city'));
            console.log('State:', formData.get('state'));
            console.log('Address:', formData.get('address'));
            console.log('Support Needed:', supportNeeded);
            console.log('Body Side:', bodySide);
            console.log('Functionality:', functionality);
            console.log('Other Functionality:', otherFunctionality);
            console.log('Functional Ability:', formData.get('functionalAbility'));
            console.log('Education:', formData.get('education'));
            console.log('Skills:', formData.get('skills'));
            console.log('Experience Data:', experienceData);
            console.log('Status:', formData.get('status'));
            
            // Save beneficiary data
            saveBeneficiaryData();
            
            function saveBeneficiaryData() {
                const beneficiaryData = {
                    id: 'BEN' + Date.now(), // Generate unique ID
                    name: formData.get('name'),
                    age: formData.get('age'),
                    gender: formData.get('gender'),
                    contact: formData.get('contact'),
                    postalCode: formData.get('postalCode'),
                    city: formData.get('city'),
                    state: formData.get('state'),
                    address: formData.get('address'),
                    supportNeeded: supportNeeded,
                    bodySide: bodySide,
                    functionality: functionality,
                    otherFunctionality: otherFunctionality,
                    functionalAbility: formData.get('functionalAbility'),
                    education: formData.get('education'),
                    skills: formData.get('skills'),
                    experience: experienceData,
                    status: 'unemployed', // All new beneficiaries start as ACTIVE (unemployed)
                    dateAdded: new Date().toLocaleDateString()
                };
                
                console.log('Beneficiary data to save:', beneficiaryData);
                console.log('STATUS CHECK - New beneficiary status:', beneficiaryData.status);
                
                // Save to Firebase
                try {
                    await addDoc(collection(db, 'beneficiaries'), beneficiaryData);
                    console.log('Beneficiary added to Firebase successfully');
                    
                    // Also save to localStorage as backup
                    let beneficiaries = JSON.parse(localStorage.getItem('beneficiaries') || '[]');
                    beneficiaries.push(beneficiaryData);
                    localStorage.setItem('beneficiaries', JSON.stringify(beneficiaries));
                    console.log('Beneficiary also saved to localStorage as backup');
                } catch (error) {
                    console.error('Error saving to Firebase:', error);
                    // Fallback to localStorage only
                    let beneficiaries = JSON.parse(localStorage.getItem('beneficiaries') || '[]');
                    beneficiaries.push(beneficiaryData);
                    localStorage.setItem('beneficiaries', JSON.stringify(beneficiaries));
                    console.log('Saved to localStorage only due to Firebase error');
                }
                
                // Show success and redirect
                setTimeout(() => {
                    successMessage.style.display = 'block';
                    submitBtn.innerHTML = '<i class="fas fa-check"></i> Added Successfully!';
                    submitBtn.style.background = 'linear-gradient(45deg, var(--success-green), #34d399)';
                    
                    console.log('Success message shown, redirecting in 2 seconds...');
                    
                    // Redirect to beneficiaries page after 2 seconds
                    setTimeout(() => {
                        console.log('Redirecting to beneficiaries.html...');
                        window.location.href = 'beneficiaries.html';
                    }, 2000);
                }, 1000);
            }
        });

        // Validation functions
        function validateForm() {
            let isValid = true;
            
            // Validate name
            const name = document.getElementById('name').value.trim();
            if (!name) {
                showError('name', 'Full name is required');
                isValid = false;
            }
            
            // Validate age
            const age = parseInt(document.getElementById('age').value);
            if (!age || age < 18) {
                showError('age', 'Age must be 18 or above');
                isValid = false;
            }
            
            // Validate gender
            const gender = document.getElementById('gender').value;
            if (!gender) {
                showError('gender', 'Please select gender');
                isValid = false;
            }
            
            // Validate contact
            const contact = document.getElementById('contact').value.trim();
            if (!contact || contact.length !== 10 || !/^\d{10}$/.test(contact)) {
                showError('contact', 'Contact number must be exactly 10 digits');
                isValid = false;
            }
            
            // Validate postal code
            const postalCode = document.getElementById('postalCode').value.trim();
            if (!postalCode || postalCode.length !== 6 || !/^\d{6}$/.test(postalCode)) {
                showError('postalCode', 'Postal code must be exactly 6 digits');
                isValid = false;
            }
            
            // Validate city
            const city = document.getElementById('city').value.trim();
            if (!city) {
                showError('city', 'City is required');
                isValid = false;
            }
            
            // Validate state
            const state = document.getElementById('state').value.trim();
            if (!state) {
                showError('state', 'State is required');
                isValid = false;
            }
            
            // Validate address
            const address = document.getElementById('address').value.trim();
            if (!address) {
                showError('address', 'Full address is required');
                isValid = false;
            }
            
            // Validate support needed
            const supportCheckboxes = document.querySelectorAll('input[name="supportNeeded"]:checked');
            if (supportCheckboxes.length === 0) {
                showError('supportNeeded', 'Please select at least one type of support needed');
                isValid = false;
            }

            // Validate body side
            const bodySideCheckboxes = document.querySelectorAll('input[name="bodySide"]:checked');
            if (bodySideCheckboxes.length === 0) {
                showError('bodySide', 'Please select at least one side of the body affected');
                isValid = false;
            }

            // Validate functional ability
            const functionalAbility = document.getElementById('functionalAbility').value.trim();
            if (!functionalAbility) {
                showError('functionalAbility', 'Please describe your functional ability');
                isValid = false;
            }
            
            // Validate education
            const education = document.getElementById('education').value;
            if (!education) {
                showError('education', 'Please select education level');
                isValid = false;
            }
            
            // Validate skills
            const skills = document.getElementById('skills').value.trim();
            if (!skills) {
                showError('skills', 'Skills are required');
                isValid = false;
            }
            
            // Validate employment status
            const status = document.getElementById('employment').value;
            if (!status) {
                showError('employment', 'Please select employment status');
                isValid = false;
            }
            
            return isValid;
        }

        function showError(fieldId, message) {
            const field = document.getElementById(fieldId);
            const errorDiv = document.getElementById(fieldId + '-error');
            
            field.classList.add('error');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        function clearErrors() {
            const errorMessages = document.querySelectorAll('.error-message');
            const errorFields = document.querySelectorAll('.form-control.error, .form-select.error');
            
            errorMessages.forEach(error => {
                error.style.display = 'none';
            });
            
            errorFields.forEach(field => {
                field.classList.remove('error');
            });
        }

        // Test localStorage functionality
        console.log('Testing localStorage...');
        localStorage.setItem('test', 'Hello World');
        console.log('Test value in localStorage:', localStorage.getItem('test'));
        
        // Navigation functionality
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                const href = this.getAttribute('href');
                
                // If it's a real link (not #), allow normal navigation
                if (href && href !== '#') {
                    return; // Allow normal navigation
                }
                
                // Only prevent default for placeholder links
                e.preventDefault();
                
                // Remove active class from all links
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                
                // Add active class to clicked link
                this.classList.add('active');
            });
        });
    </script>
</body>
</html>
